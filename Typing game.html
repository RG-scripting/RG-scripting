<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        #sentence {
            font-size: 24px;
            margin: 20px 0;
        }
        #input {
            font-size: 20px;
            width: 80%;
            padding: 10px;
        }
        #output {
            font-size: 20px;
            margin: 20px 0;
            white-space: pre-wrap;
        }
        #startButton, #restartButton {
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
        }
        .correct {
            color: green;
        }
        .incorrect {
            color: red;
        }
        #result {
            font-size: 20px;
            margin-top: 20px;
        }
        #ownerMenu {
            display: none;
            position: absolute;
            border: 1px solid #ccc;
            background-color: white;
            padding: 10px;
            width: 300px;
            z-index: 1000;
        }
        .minimized {
            height: 40px;
            overflow: hidden;
        }
        .key-pressed {
            animation: keypress-effect 0.2s ease;
        }
        @keyframes keypress-effect {
            0% { background-color: rgba(0, 255, 0, 0.5); }
            100% { background-color: transparent; }
        }
        #topTimes {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>100 Sentence Typing Challenge</h1>
    <div id="sentence"></div>
    <input type="text" id="input" placeholder="Start typing..." autofocus>
    <br>
    <button id="startButton">Start Game</button>
    <button id="restartButton" style="display:none;">Restart Game</button>
    <div id="result"></div>
    <div id="output"></div>

    <div id="ownerMenu" class="draggable">
        <h2>Owner Menu <button id="minimizeButton">_</button></h2>
        <label>
            <input type="checkbox" id="autocorrectToggle" checked>
            Enable Auto-Correct
        </label>
        <br>
        <button id="exitOwnerMenu">Exit Owner Menu</button>
        <div id="deleteEntry">
            <button id="removeUserButton">Remove User</button>
        </div>
    </div>

    <div id="topTimes">
        <h2>Top Times</h2>
        <ul id="timesList"></ul>
    </div>

    <script>
        const sentences = [
            "The quick brown fox jumps over the lazy dog.",
            "A journey of a thousand miles begins with a single step.",
            "To be or not to be, that is the question.",
            "All that glitters is not gold.",
            "A penny saved is a penny earned.",
            "Actions speak louder than words.",
            "Beauty is in the eye of the beholder.",
            "Better late than never.",
            "Birds of a feather flock together.",
            "Cleanliness is next to godliness.",
            "Do not count your chickens before they hatch.",
            "Don't bite the hand that feeds you.",
            "Don't put all your eggs in one basket.",
            "Every cloud has a silver lining.",
            "Fortune favors the bold.",
            "Good things come to those who wait.",
            "Honesty is the best policy.",
            "If it ain't broke, don't fix it.",
            "If you can't stand the heat, get out of the kitchen.",
            "It's no use crying over spilled milk.",
            "Jack of all trades, master of none.",
            "Knowledge is power.",
            "Laughter is the best medicine.",
            "Let sleeping dogs lie.",
            "Like father, like son.",
            "Money doesn't grow on trees.",
            "No man is an island.",
            "Practice makes perfect.",
            "Rome wasn't built in a day.",
            "Slow and steady wins the race.",
            "The apple doesn't fall far from the tree.",
            "The early bird catches the worm.",
            "The grass is always greener on the other side.",
            "The pen is mightier than the sword.",
            "The road to hell is paved with good intentions.",
            "There's no place like home.",
            "Time and tide wait for no man.",
            "What goes around comes around.",
            "When in Rome, do as the Romans do.",
            "You can't have your cake and eat it too.",
            "You can't judge a book by its cover.",
            "You reap what you sow.",
            "Absence makes the heart grow fonder.",
            "Actions have consequences.",
            "All good things must come to an end.",
            "An ounce of prevention is worth a pound of cure.",
            "Beggars can't be choosers.",
            "Blood is thicker than water.",
            "Brevity is the soul of wit.",
            "Clean your room before you complain about the world.",
            "Curiosity killed the cat.",
            "Every rose has its thorn.",
            "Familiarity breeds contempt.",
            "Good fences make good neighbors.",
            "Hope for the best, prepare for the worst.",
            "If you want something done right, do it yourself.",
            "It takes two to tango.",
            "Knowledge speaks, but wisdom listens.",
            "Let the cat out of the bag.",
            "Love conquers all.",
            "Misery loves company.",
            "No pain, no gain.",
            "One man's trash is another man's treasure.",
            "Opportunity knocks but once.",
            "Out of sight, out of mind.",
            "Pride comes before a fall.",
            "Roses are red, violets are blue.",
            "Silence is golden.",
            "The best things in life are free.",
            "The devil is in the details.",
            "The grass is always greener on the other side.",
            "The more things change, the more they stay the same.",
            "There's no time like the present.",
            "To err is human, to forgive divine.",
            "Two heads are better than one.",
            "Variety is the spice of life.",
            "When life gives you lemons, make lemonade.",
            "You can't make an omelet without breaking eggs.",
            "You can't teach an old dog new tricks.",
            "Your guess is as good as mine.",
            "A watched pot never boils.",
            "A bird in the hand is worth two in the bush.",
            "A fool and his money are soon parted.",
            "A house divided against itself cannot stand.",
            "A picture is worth a thousand words.",
            "All's fair in love and war.",
            "As you sow, so shall you reap.",
            "Better safe than sorry.",
            "Cleanliness is next to godliness.",
            "Don't put off until tomorrow what you can do today.",
            "Don't throw the baby out with the bathwater.",
            "Every dog has its day.",
            "Fools rush in where angels fear to tread.",
            "Great minds think alike.",
            "Haste makes waste.",
            "If the shoe fits, wear it.",
            "If you can't beat them, join them.",
            "Imitation is the sincerest form of flattery.",
            "Itâ€™s the thought that counts.",
            "Jack be nimble, Jack be quick.",
            "Knowledge is power.",
            "Last but not least.",
            "Like two peas in a pod.",
            "Money talks.",
            "Never look a gift horse in the mouth.",
            "Old habits die hard.",
            "Practice what you preach.",
            "Rain on my parade.",
            "Seeing is believing.",
            "Spare the rod and spoil the child.",
            "The ball is in your court.",
            "The calm before the storm.",
            "The proof is in the pudding.",
            "The tides of change.",
            "There's no such thing as a free lunch.",
            "Throw caution to the wind.",
            "Turn over a new leaf.",
            "Two wrongs don't make a right.",
            "When the going gets tough, the tough get going.",
            "You can't always get what you want.",
            "You can't please everyone."
        ];

        let currentSentenceIndex = 0;
        let startTime;
        let ownerMode = false;
        let autocorrectEnabled = true;
        let timeInterval;
        let userName = "";
        const topTimes = [];
        const topTimesKey = 'topTimes';

        async function loadLeaderboard() {
            const response = await fetch('http://localhost:3000/leaderboard');
            const data = await response.json();
            data.forEach(entry => topTimes.push(entry));
            updateLeaderboardDisplay();
        }

        async function postLeaderboardEntry(name, time) {
            await fetch('http://localhost:3000/leaderboard', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name, time })
            });
        }

        const sentenceElement = document.getElementById('sentence');
        const inputElement = document.getElementById('input');
        const outputElement = document.getElementById('output');
        const resultElement = document.getElementById('result');
        const startButton = document.getElementById('startButton');
        const restartButton = document.getElementById('restartButton');
        const ownerMenu = document.getElementById('ownerMenu');
        const removeUserButton = document.getElementById('removeUserButton');
        const exitOwnerMenuButton = document.getElementById('exitOwnerMenu');

        startButton.addEventListener('click', startGame);
        inputElement.addEventListener('input', checkInput);
        restartButton.addEventListener('click', restartGame);
        removeUserButton.addEventListener('click', promptForUsernameToRemove);
        exitOwnerMenuButton.addEventListener('click', exitOwnerMode);
        document.getElementById('minimizeButton').addEventListener('click', toggleMinimize);

        function startGame() {
            currentSentenceIndex = Math.floor(Math.random() * sentences.length);
            sentenceElement.textContent = sentences[currentSentenceIndex];
            inputElement.value = '';
            inputElement.disabled = false;
            inputElement.focus();
            startTime = Date.now();
            updateTime();
            restartButton.style.display = 'none';
            resultElement.textContent = '';
            outputElement.textContent = '';
        }

        function checkInput() {
            const userInput = inputElement.value;
            const currentSentence = sentences[currentSentenceIndex];

            if (autocorrectEnabled) {
                const correctText = currentSentence.slice(0, userInput.length);
                const correct = userInput === correctText;

                outputElement.textContent = correct ? '' : 'Incorrect input!';
                if (!correct) {
                    inputElement.classList.add('incorrect');
                } else {
                    inputElement.classList.remove('incorrect');
                }
            }

            if (userInput === currentSentence) {
                endGame();
            }
        }

        function endGame() {
            clearInterval(timeInterval);
            const timeTaken = Math.floor((Date.now() - startTime) / 1000);
            resultElement.textContent = `Time: ${timeTaken} seconds`;
            userName = prompt("Enter your username:");
            if (userName) {
                postLeaderboardEntry(userName, timeTaken);
                topTimes.push({ name: userName, time: timeTaken });
                topTimes.sort((a, b) => a.time - b.time);
                updateLeaderboardDisplay();
            }
            restartButton.style.display = 'inline';
            inputElement.disabled = true;
        }

        function updateLeaderboardDisplay() {
            const timesList = document.getElementById('timesList');
            timesList.innerHTML = '';
            topTimes.forEach(user => {
                const listItem = document.createElement('li');
                listItem.textContent = `${user.name}: ${user.time} seconds`;
                timesList.appendChild(listItem);
            });
        }

        function promptForUsernameToRemove() {
            const password = prompt("Enter password to remove a user:");
            if (password === "lauReli5") {
                const usernameToRemove = prompt("Enter the username to remove from the leaderboard:");
                if (usernameToRemove) {
                    const response = fetch(`http://localhost:3000/leaderboard/${usernameToRemove}`, {
                        method: 'DELETE'
                    });

                    if (response.ok) {
                        const index = topTimes.findIndex(user => user.name === usernameToRemove);
                        if (index !== -1) {
                            topTimes.splice(index, 1);
                            alert(`${usernameToRemove} has been removed from the leaderboard.`);
                            updateLeaderboardDisplay();
                        } else {
                            alert(`User ${usernameToRemove} not found.`);
                        }
                    } else {
                        alert("Failed to remove user.");
                    }
                } else {
                    alert("No username entered.");
                }
            } else {
                alert("Incorrect password.");
            }
        }

        function restartGame() {
            inputElement.value = '';
            resultElement.textContent = '';
            outputElement.textContent = '';
            startButton.style.display = 'inline';
            restartButton.style.display = 'none';
            sentenceElement.textContent = '';
            inputElement.disabled = true;
            ownerMode = false;
            ownerMenu.style.display = 'none';
            clearInterval(timeInterval);
            userName = "";
        }

        function toggleMinimize() {
            ownerMenu.classList.toggle('minimized');
        }

        function dragMouseDown(e) {
            e.preventDefault();
            let pos1 = e.clientX;
            let pos2 = e.clientY;

            document.onmouseup = closeDragElement;
            document.onmousemove = elementDrag;

            function elementDrag(e) {
                e.preventDefault();
                let pos3 = pos1 - e.clientX;
                let pos4 = pos2 - e.clientY;
                pos1 = e.clientX;
                pos2 = e.clientY;
                ownerMenu.style.top = (ownerMenu.offsetTop - pos4) + "px";
                ownerMenu.style.left = (ownerMenu.offsetLeft - pos3) + "px";
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        ownerMenu.addEventListener('mousedown', dragMouseDown);
        window.onload = loadLeaderboard();

        function updateTime() {
            timeInterval = setInterval(() => {
                // Update game time if needed
            }, 1000);
        }
    </script>
</body>
</html>
